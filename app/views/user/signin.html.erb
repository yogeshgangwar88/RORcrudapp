<section class="vh-100">
  <div class="container-fluid h-custom">
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col-md-9 col-lg-6 col-xl-5">
        <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-login-form/draw2.webp"
          class="img-fluid" alt="Sample image">
      </div>
      <div class="col-md-8 col-lg-6 col-xl-4 offset-xl-1">
        <%= render partial:"shared/flash"  %>

      <form id="form1" name="usert" action="<%= login_path %>" method="POST">
        <%= token_tag %>
          <div class="form-outline mb-4">
            <input type="email" name="email" id="form3Example3" class="form-control form-control-lg"
              placeholder="Enter a valid email address" />
            <label class="form-label" for="form3Example3">Email address</label>
          </div>

          <!-- Password input -->
          <div class="form-outline mb-3">
            <input type="password" name="password" id="form3Example4" class="form-control form-control-lg"
              placeholder="Enter password" />
            <label class="form-label" for="form3Example4">Password</label>
          </div>

          <div class="d-flex justify-content-between align-items-center">
            <!-- Checkbox -->
            <div class="form-check mb-0">
              <input class="form-check-input me-2" type="checkbox" value="" id="form2Example3" />
              <label class="form-check-label" for="form2Example3">
                Remember me
              </label>
            </div>
            <a href="#"  class="text-body">Forgot password?</a>
          </div>

          <div class="text-center text-lg-start mt-4 pt-2">
            <button type="submit" class="btn btn-primary" style="padding-left: 2.5rem; padding-right: 2.5rem;">Login</button>
              <a class="btn btn-primary fb btn float-end" onclick="loginhit();"><i class="fa fa-facebook fa-fw"></i> Login with Facebook</a>
            <p class="small fw-bold mt-2 pt-1 mb-0">Don't have an account? <a href="/register"  class="link-danger">Register</a></p>
          </div>

        </form>
      </div>
    </div>
  </div>

</section>

<body>
<script>

  window.fbAsyncInit = function() {
    FB.init({
      appId      : '925169898453579',
      cookie     : true,                     // Enable cookies to allow the server to access the session.
      xfbml      : true,                     // Parse social plugins on this webpage.
      version    : 'v15.0'           // Use this Graph API version for this call.
    });

  };


function loginhit() {

FB.login(function(response) {
    console.log('fb login');
    console.log(response);
    if(response.status=="connected"){
      FB.api('/me', {fields: 'id,name,email'}, function(detailresp) {
      console.log(detailresp);
		  swal.fire({text: "Logged in as "+detailresp.name,title:"Success",type: "success",icon:"success",confirmButtonColor:"#0d6efd"}).then(function() {
      const  mydata={userid:response.authResponse.userID, accessToken:response.authResponse.accessToken, signedRequest:response.authResponse.signedRequest};
      $.ajax({
        type: "POST",
        url: "/fbuserlogin",
        data: mydata,
        success: function(data, textStatus, jqXHR){
                  window.location.href='/userprofile'
        },
        error: function(jqXHR, textStatus, errorThrown){
        swal.fire({text: "something went wrong please try again...",title:"Login failed",type: "error",icon:"error",confirmButtonColor:"#0d6efd"})
        }
      });
      }
      );

      });

    }
    else{
    swal.fire({text: "something went wrong,please try again...",title:"Login failed",type: "error",icon:"error",confirmButtonColor:"#0d6efd"})

    }

})


}
</script>

<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>
</body>
</html>
<style>
.fb {
  background-color: #3B5998;
  color: white;
}
.divider:after,
.divider:before {
content: "";
flex: 1;
height: 1px;
background: #eee;
}
.h-custom {
height: calc(100% - 73px);
}
@media (max-width: 450px) {
.h-custom {
height: 100%;
}
}

.divider:after,
.divider:before {
content: "";
flex: 1;
height: 1px;
background: #eee;
}
.h-custom {
height: calc(100% - 73px);
}
@media (max-width: 450px) {
.h-custom {
height: 100%;
}
}
</style>
